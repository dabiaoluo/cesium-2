<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <meta name="description" content="Use Viewer to start building new applications or easily embed Cesium into existing applications.">
    <meta name="cesium-sandcastle-labels" content="Beginner, Showcases">
    <title>Cesium Demo</title>
    <script type="text/javascript" src="../Sandcastle-header.js"></script>
    <script type="text/javascript" src="../../../ThirdParty/requirejs-2.1.20/require.js"></script>
    <script type="text/javascript">
    require.config({
        baseUrl : '../../../Source',
        waitSeconds : 60
    });
    </script>
</head>
<body class="sandcastle-loading" data-sandcastle-bucket="bucket-requirejs.html">
<style>
    @import url(../templates/bucket.css);
</style>
<div id="cesiumContainer" class="fullSize"></div>
<div id="loadingOverlay"><h1>Loading...</h1></div>
<div id="toolbar"></div>
<script id="cesium_sandcastle_script">
function startup(Cesium) {
    'use strict';
//Sandcastle_Begin
var viewer = new Cesium.Viewer('cesiumContainer',{
	animation : false,// 是否创建动画小器件，左下角仪表
	baseLayerPicker : false,// 是否显示图层选择器
	fullscreenButton : true,// 是否显示全屏按钮
	geocoder : false,// 是否显示geocoder小器件，右上角查询按钮
	homeButton : true,// 是否显示Home按钮
	infoBox : true,// 是否显示信息框
	sceneModePicker : true,// 是否显示3D/2D选择器
	selectionIndicator : true,// 是否显示选取指示器组件
	timeline : false,// 是否显示时间轴
	navigationHelpButton : false,// 是否显示右上角的帮助按钮
	scene3DOnly : false,// 如果设置为true，则所有几何图形以3D模式绘制以节约GPU资源
	/*selectedImageryProviderViewModel : imageryViewModels[0],// 当前图像图层的显示模型，仅baseLayerPicker设为true有意义
	imageryProviderViewModels : imageryViewModels,// 可供BaseLayerPicker选择的图像图层ProviderViewModel数组
	terrainProviderViewModels : [],// 可供BaseLayerPicker选择的地形图层ProviderViewModel数组
	selectedTerrainProviderViewModel : undefined,// 当前地形图层的显示模型，仅baseLayerPicker设为true有意义
*/			imageryProvider :  new Cesium.createOpenStreetMapImageryProvider({
		url : 'http://172.16.33.15/osm_hot/'
	}),// 图像图层提供者，仅baseLayerPicker设为false有意义
	terrainProvider : new Cesium.CesiumTerrainProvider({
		url : 'http://172.16.33.15/terrain/'
	}),// 地形图层提供者，仅baseLayerPicker设为false有意义
	skyBox : new Cesium.SkyBox(
	{
		sources : {
			positiveX : 'Cesium/Assets/Textures/SkyBox/tycho2t3_80_px.jpg',
			negativeX : 'Cesium/Assets/Textures/SkyBox/tycho2t3_80_mx.jpg',
			positiveY : 'Cesium/Assets/Textures/SkyBox/tycho2t3_80_py.jpg',
			negativeY : 'Cesium/Assets/Textures/SkyBox/tycho2t3_80_my.jpg',
			positiveZ : 'Cesium/Assets/Textures/SkyBox/tycho2t3_80_pz.jpg',
			negativeZ : 'Cesium/Assets/Textures/SkyBox/tycho2t3_80_mz.jpg'
		}
	}),// 用于渲染星空的SkyBox对象
	fullscreenElement : document.body,// 全屏时渲染的HTML元素,
	useDefaultRenderLoop : true,// 如果需要控制渲染循环，则设为true
	targetFrameRate : undefined,// 使用默认render loop时的帧率
	showRenderLoopErrors : true,// 如果设为true，将在一个HTML面板中显示错误信息
	automaticallyTrackDataSourceClocks : true,// 自动追踪最近添加的数据源的时钟设置
	contextOptions : undefined,// 传递给Scene对象的上下文参数（scene.options）
	sceneMode : Cesium.SceneMode.SCENE3D,// 初始场景模式
	mapProjection : new Cesium.WebMercatorProjection(),// 地图投影体系
	dataSources : new Cesium.DataSourceCollection()// 需要进行可视化的数据源的集合
});
var ellipsoid = viewer.scene.globe.ellipsoid;  
//建筑物实验
var positions1 =[Cesium.Cartographic.fromDegrees(103.546567, 31.443966),
                Cesium.Cartographic.fromDegrees(103.546540, 31.443362),
				  Cesium.Cartographic.fromDegrees( 103.546285, 31.443370),
				  Cesium.Cartographic.fromDegrees(103.546311, 31.443969),
				  Cesium.Cartographic.fromDegrees(103.546567, 31.443966)
];
var temp2 = Cesium.sampleTerrain(viewer.terrainProvider, 12, positions1);
            Cesium.when(temp2, function(updatedPositions) {
            	var raisedPositions = ellipsoid.cartographicArrayToCartesianArray(updatedPositions);  
		  var redPolygon = viewer.entities.add({
			  name : 'Red polygon on surface',
			  polygon : {
			     /*hierarchy:Cesium.Cartesian3.fromDegreesArrayHeights([103.546567,31.443966, positions1[0].height,
			                                                     103.546540, 31.443362,positions1[1].height,
			                                                     103.546285, 31.443370,positions1[2].height,
			                                                     103.546311, 31.443969,positions1[3].height,
			                                                     103.546567, 31.443966,positions1[4].height]),*/
			      	hierarchy:raisedPositions,
					perPositionHeight:true,
					//hierarchy:cartesianPositions,		
			      material : Cesium.Color.RED,
			      extrudedHeight: 100.0,
					//setdeeptestagainstterrain:true,
					
			  }
		});
		  viewer.zoomTo(viewer.entities);
});



//Sandcastle_End
    Sandcastle.finishedLoading();
}
if (typeof Cesium !== "undefined") {
    startup(Cesium);
} else if (typeof require === "function") {
    require(["Cesium"], startup);
}
</script>
</body>
</html>
